(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12740,        339]
NotebookOptionsPosition[     12192,        315]
NotebookOutlinePosition[     12547,        331]
CellTagsIndexPosition[     12504,        328]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"L", ".", "T", ".", " ", "11"}], "/", "19"}], "/", "2014"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DiscWithMat", "[", "X_", "]"}], " ", ":=", "\[IndentingNewLine]", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "N", ",", "Y", ",", "Z", ",", "Q", ",", "fn", ",", "Dirac", ",", "yq", 
       ",", "D", ",", "zq", ",", "zqd"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Dirac", "[", "f_", "]"}], ":=", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"f", "[", "#", "]"}], ",", "1", ",", "0"}], "]"}], " ", 
         "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", 
         RowBox[{"{", 
          RowBox[{"v_", ",", "w_", ",", "x_"}], "}"}], "]"}], ":=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"w", "-", "v"}], ",", 
            RowBox[{"x", "-", "v"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"w", "-", "v"}], ",", 
             RowBox[{"x", "-", "v"}]}], "]"}], ".", "x"}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"N", " ", "=", " ", 
        RowBox[{"Length", "[", "X", "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", "N", "]"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yq", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"fn", ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"X", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", "yq", "]"}], "*)"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Y", " ", "=", " ", 
       RowBox[{"yq", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", "Y", "]"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Q", " ", "=", " ", 
       RowBox[{"yq", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", "Q", "]"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Z", " ", "=", " ", 
       RowBox[{"X", ".", 
        RowBox[{"Transpose", "[", "Y", "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"Print", "[", "Z", "]"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zq", " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", " ", "-", " ", "Q"}], " ", "&"}], ",", "Z"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", "zq", "]"}], "*)"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"zqd", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"Dirac", "[", 
          RowBox[{
           RowBox[{"#", " ", ">=", " ", "0"}], " ", "&"}], "]"}], ",", "zq", 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", "zqd", "]"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"D", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "N"}], ")"}], 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Plus", " ", "@@", " ", "#"}], "&"}], ",", "zqd"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Max", "[", "D", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.625462467655488*^9, 3.625462539487115*^9}, {
   3.62546257588804*^9, 3.625462705447263*^9}, {3.625462842094644*^9, 
   3.6254628743105173`*^9}, {3.625462921606505*^9, 3.625462957967567*^9}, {
   3.625462997195706*^9, 3.625463089678907*^9}, 3.625463149950707*^9, {
   3.6254632409252768`*^9, 3.62546337314336*^9}, {3.625463403752239*^9, 
   3.6254634567344723`*^9}, {3.625464018616745*^9, 3.625464087523941*^9}, {
   3.625464151873254*^9, 3.625464154095295*^9}, {3.625464231471472*^9, 
   3.625464241883568*^9}, {3.625464299587549*^9, 3.625464332710829*^9}, {
   3.6254646247689447`*^9, 3.625464631445581*^9}, {3.625464680578351*^9, 
   3.625464694054616*^9}, {3.6254647668903627`*^9, 3.6254648162014217`*^9}, {
   3.6254649416278133`*^9, 3.625464945012721*^9}, {3.625465041685728*^9, 
   3.625465078685601*^9}, {3.625465153591587*^9, 3.6254651636162157`*^9}, {
   3.625465226785*^9, 3.62546524763525*^9}, 3.6254654565284147`*^9, {
   3.625994900476201*^9, 3.625994924830394*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FLPS", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Fn", ",", "r"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Fn", "=", 
       RowBox[{"Fibonacci", "[", "n", "]"}]}], ";", 
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "-", "1"}], "]"}], "/", "Fn"}]}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k", "/", "Fn"}], ",", 
          RowBox[{"FractionalPart", "[", 
           RowBox[{"k", " ", "r"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{"Fn", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Phi", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", 
       SqrtBox[
        RowBox[{"y", "-", 
         SuperscriptBox["y", "2"]}]], 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Pi]", " ", "x"}], "]"}]}], ",", 
      RowBox[{"2", 
       SqrtBox[
        RowBox[{"y", "-", 
         SuperscriptBox["y", "2"]}]], 
       RowBox[{"Sin", "[", 
        RowBox[{"2", "\[Pi]", " ", "x"}], "]"}]}], ",", 
      RowBox[{"1", "-", 
       RowBox[{"2", "y"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NsphFLPS", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Phi", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"FLPS", "[", "n", "]"}]}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TetraPts", ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}], "}"}], "/", 
    RowBox[{"Norm", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.519338664973*^9, 3.519338695363625*^9}, {
   3.5193387381605*^9, 3.519338760707375*^9}, {3.519338970473*^9, 
   3.51933900944175*^9}, {3.519339069223*^9, 3.5193391275355*^9}, {
   3.519339157973*^9, 3.5193391724105*^9}, {3.5193392306605*^9, 
   3.51933928350425*^9}, {3.519339316863625*^9, 3.519339478019875*^9}, 
   3.519339646801125*^9, {3.5193397001605*^9, 3.519339738098*^9}, {
   3.51933978625425*^9, 3.519339887238625*^9}, {3.519339922582375*^9, 
   3.51933999487925*^9}, {3.519340040082375*^9, 3.51934010287925*^9}, {
   3.5193401882855*^9, 3.5193402477855*^9}, {3.51934028569175*^9, 
   3.519340293894875*^9}, {3.519340364019875*^9, 3.519340379269875*^9}, {
   3.519341678238625*^9, 3.5193417332855*^9}, {3.51934177794175*^9, 
   3.519342008473*^9}, {3.5193420729105*^9, 3.519342079332375*^9}, {
   3.519342228082375*^9, 3.519342292098*^9}, {3.51934262131675*^9, 
   3.519342659426125*^9}, {3.519342694598*^9, 3.519342704769875*^9}, {
   3.519342877863625*^9, 3.519342891301125*^9}, {3.519343104926125*^9, 
   3.5193432546605*^9}, {3.519343294223*^9, 3.519343324144875*^9}, 
   3.519343359676125*^9, {3.519343393551125*^9, 3.519343406644875*^9}, {
   3.519343445019875*^9, 3.519343448973*^9}, {3.519343518301125*^9, 
   3.51934352275425*^9}, 3.519343609582375*^9, {3.519343647707375*^9, 
   3.519343668144875*^9}, {3.519966408808*^9, 3.519966465729875*^9}, {
   3.519966505854875*^9, 3.51996652102675*^9}, {3.519966554698625*^9, 
   3.51996655990175*^9}, {3.5199666366205*^9, 3.519966644933*^9}, 
   3.519966676511125*^9, {3.519966758761125*^9, 3.5199667672455*^9}, {
   3.52004877315175*^9, 3.52004882221425*^9}, {3.620712606603133*^9, 
   3.620712716568294*^9}, {3.625463507594304*^9, 3.625463513917626*^9}, {
   3.625463555062277*^9, 3.625463556006382*^9}, {3.625465398798122*^9, 
   3.62546540772535*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DiscWithMat", "[", 
   RowBox[{"NsphFLPS", "[", "8", "]"}], "]"}], " ", "//", " ", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.625463562537689*^9, 3.625463580182637*^9}, {
  3.625463702305377*^9, 3.625463706414694*^9}, {3.625464347472089*^9, 
  3.625464347507105*^9}, {3.625464392787937*^9, 3.625464392852194*^9}, {
  3.625465301424576*^9, 3.625465342677981*^9}, {3.625465411613721*^9, 
  3.625465413597863*^9}, {3.6254655011552*^9, 3.625465569634494*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.34215000000000000968114477473136503249`5.554816457611953", ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.625463581431284*^9, 3.625463716809647*^9, {3.625464141837337*^9, 
   3.625464166519376*^9}, 3.625464244936839*^9, {3.625464339047284*^9, 
   3.6254643482869663`*^9}, 3.6254643937534*^9, 3.625464642197077*^9, 
   3.6254646992745237`*^9, 3.625464902509431*^9, 3.625464972130003*^9, 
   3.625465092325268*^9, 3.625465179721786*^9, {3.625465294183432*^9, 
   3.625465311478002*^9}, 3.625465343188033*^9, 3.625465415621975*^9, 
   3.625465461685144*^9, 3.6254655304298697`*^9, 3.625465571773044*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ZZZ", "[", "4", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.0774889518984743`", ",", 
     RowBox[{"-", "0.49154321254808375`"}], ",", 
     RowBox[{"-", "0.8673988312948002`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9525312080409841`", ",", 
     RowBox[{"-", "0.00523111265769369`"}], ",", "0.30439601371953895`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4673375460189925`", ",", "0.46155082640004585`", ",", 
     RowBox[{"-", "0.7540334559755162`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11737666022939484`", ",", "0.39591121504138027`", ",", 
     RowBox[{"-", "0.9107562953050894`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.625464874049625*^9}]
}, Open  ]]
},
WindowSize->{808, 656},
WindowMargins->{{173, Automatic}, {Automatic, 43}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4923, 117, 454, "Input"],
Cell[5484, 139, 4708, 121, 198, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[10217, 264, 502, 9, 28, "Input"],
Cell[10722, 275, 655, 12, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11414, 292, 56, 1, 28, "Input"],
Cell[11473, 295, 703, 17, 46, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
